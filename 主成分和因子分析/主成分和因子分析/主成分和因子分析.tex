\documentclass[a4paper,12pt]{article} %文档类型
\usepackage{CJK}
\usepackage{ctex}
\usepackage{color}
\usepackage{amsmath,amssymb,amstext} %多种公式环境和数学命令
\usepackage{float}
\usepackage{array}           %数组和表格制作
\usepackage{fancyhdr}        %页眉页脚设置
\usepackage{graphicx}        %插图
\usepackage{tabularx}        %自动设置表格列宽
\usepackage{multirow}        %跨行表格
\usepackage{multicol}        %跨列表格
\usepackage{titlesec}        %标题设置
\usepackage{titletoc}        %目录格式设置
\usepackage{epstopdf}        %编译生成pdf时，能够插入eps格式图片
\usepackage[top=2.5cm,bottom=2.0cm,left=2.0cm,right=2.0cm]{geometry} % 页边距
\newcommand{\hei}{\CJKfamily{hei}}  % 定义的新命令
\newcommand{\li}{\CJKfamily{li}}
\renewcommand{\figurename}{{图}}
\linespread{1.7}   %1.5倍行距
\usepackage{listings}
\usepackage{xcolor}
 %\lstset{
%   %行号
%   numbers=left,
%   %背景框
%   framexleftmargin=10mm,
%   frame=none,
%   %背景色
%   %backgroundcolor=\color[rgb]{1,1,0.76},
%   backgroundcolor=\color[RGB]{245,245,244},
%   %样式
%   keywordstyle=\bf\color{blue},
%   identifierstyle=\bf,
%   numberstyle=\color[RGB]{0,192,192},
%   commentstyle=\it\color[RGB]{0,96,96},
%   stringstyle=\rmfamily\slshape\color[RGB]{128,0,0},
%   %显示空格
%   showstringspaces=false
%}
%\lstset{numbers=left, numberstyle=\tiny, keywordstyle=\color{blue!70}, commentstyle=\color{red!50!green!50!blue!50}, frame=shadowbox, rulesepcolor=\color{red!20!green!20!blue!20},escapeinside=``, xleftmargin=2em,xrightmargin=2em, aboveskip=1em, escapeinside=``}

\lstset{numbers=left, %设置行号位置
        numberstyle=\tiny, %设置行号大小
        keywordstyle=\color{blue!70}, %设置关键字颜色
        commentstyle=\color[cmyk]{1,0,1,0}, %设置注释颜色
        frame=shadowbox, %设置边框格式
        rulesepcolor=\color{red!20!green!20!blue!20},
        escapeinside=``, %逃逸字符(1 左面的键)，用于显示中文
        breaklines, %自动折行
        extendedchars=false, %解决代码跨页时，章节标题，页眉等汉字不显示的问题
        xleftmargin=2em,xrightmargin=2em, aboveskip=1em, % 设置边距
        %tabsize=4, %设置tab空格数
        %showspaces=false %不显示空格
       }
\begin{document}

\begin{center}
\large
\heiti{530~~陈斯杰~~电子信息工程~~第15次作业}
\end{center}
\textbf{一、主成分分析}\\
1、首先我们将数据进行标准化，并求出相关系数矩阵的特征值与特征向量。由累计贡献率$\geq85\%$可得，主成分个数为3，相应的特征值为\\
$\lambda_{1}=3.1046$,$\lambda_{2}=2.8975$,$\lambda_{2}=0.9302$\\
相应的特征向量为\\
\begin{center}
  \includegraphics[width=0.7\textwidth]{1_1_1.jpg}\\
\end{center}
求解出相应的主成分为$Z_{1},Z_{2},Z_{3}$\\
$Y=0.3881\times Z_{1}+0.3622\times Z_{2}+0.1163\times Z_{3}$
\begin{center}
  \includegraphics[width=0.7\textwidth]{1_1_2.jpg}\\
\end{center}
求解出相应的主成分为$Z_{1},Z_{2},Z_{3}$\\
此时，综合得分越小越好。\\
~\\
2.\\
将数据输入MATLAB求解，得到综合变量Z1与Z2
\small
\begin{lstlisting}[language=Matlab][b]
%q1_2
clear;clc;
A=[ 843 4000 920 1083 1166 1536 1692 2743 2741
 942 5215 1216 1280 1549 1924 2717 3743 4160
 895 6379 1836 2287 2715 3218 3240 4572 5439
 884 3770 978 1010 1227 1558 1755 2552 2632
 1002 3329 757 684 718 931 1422 1827 2222
 792 3039 759 765 1253 1296 1902 1822 2233
 930 2476 559 616 611 863 891 1539 1768
 758 2127 633 661 762 769 864 1241 1482
 886 2721 703 836 813 914 895 1272 1431
 859 1664 427 451 507 551 581 839 1107
 808 2435 772 790 839 990 771 1132 1316
 845 2661 557 599 670 855 1128 1639 1861
 877 2242 549 471 480 643 664 1173 1530
 787 3088 1061 1021 978 1102 1301 2373 2452
 943 3322 567 557 630 836 984 1994 2704
 866 3507 675 678 847 1187 1476 2107 2415
 924 3412 545 729 821 1017 1079 1878 2325
 1806 5869 1268 1227 1607 1765 2318 2959 3157
 1027 3605 651 835 924 1125 1194 2176 2411];%原始数据
for i=1:9
    SA(:,i)=(A(:,i)-mean(A(:,i)))/std(A(:,i)); %标准化
end
CM=corrcoef(SA);%系数矩阵
[V,D]=eig(CM);%特征值与特征向量
for i=1:9
    DS(i,1)=D(10-i,10-i);
end
%计算贡献率
for i=1:9
    DS(i,2)=DS(i,1)/sum(DS(:,1));%单个贡献率
    DS(i,3)=sum(DS(1:i,1))/sum(DS(:,1));%累计贡献率
end
%假定主成分的信息保留率为T
T=0.95;
for k=1:9
    if DS(k,3) >= T
        com_num=k;
        break;
    end
end
%提取主成分的特征向量
for j=1:com_num
    PV(:,j)=V(:,10-j);
end
%计算主成分得分
new_score=SA*PV;
for i=1:19
    total_score(i,1)=sum(new_score(i,:));
    total_score(i,2)=i;
end
%强主成分得分与总分放到同一个矩阵中
result_report=[new_score,total_score];
%按总分降序排列
result_report=sortrows(result_report,-com_num-1);
%输出结果
disp('特征值、贡献率、累计贡献率：')
DS
disp('信息保留率T对应的主成分数与特征向量：')
com_num
PV
disp('主成分得分及排序（最后一列为编号，其次为总得分）')
result_report
\end{lstlisting}
\large
得到排序结果：[3,2,1,4,14,6,18,16,19,17,,5,11,9,15,12,8,7,13,10]\\
~\\
3.(1)导入数据，求出相关系数矩阵
\begin{lstlisting}[language=R][b]
setwd('F:\\XMU files\\数学竞赛\\数学建模\\CH15')
tt <- read.table('3.txt',header = F,sep = ' ')
rownames(tt) = c("煤矿",'石油','黑色','有色','非金属','其他')
colnames(tt)=c('x1','x2','x3','x4','x5','x6')#("资产总计",'固定资产净值','从业人员/万人','工业产值','主营业务收入','利润总额')
a <- cor(tt)
\end{lstlisting}
输出结果为：
\begin{center}
  \includegraphics[scale=0.9]{fig3_1.jpg}
\end{center}

(2)求出相关系数矩阵的特征值和特征向量。
\begin{lstlisting}[language=R][b]
eigen(a)
\end{lstlisting}
输出结果为：
\begin{center}
  \includegraphics[scale=0.7]{fig3_2.jpg}
\end{center}


(3)求解方差贡献率和荷载矩阵。
\begin{lstlisting}[language=R][b]
test.pr <- princomp(tt,cor = T)
summary(test.pr,loading = T)
\end{lstlisting}
输出结果为：
\begin{center}
  \includegraphics[scale=0.7]{fig3_3.jpg}
\end{center}

(4)数据标准化，求主成分表达式，求综合得分。
\begin{lstlisting}[language=R][b]
zu <- as.data.frame(scale(tt))
attach(zu)
pc1 <- -0.430*x1-0.422*x2-0.367*x3-0.431*x4-0.431*x5-0.362*x6
y <- 0.8911984*pc1
detach(zu)
行业 <- c("煤矿",'石油','黑色','有色','非金属','其他')
zu1 <- data.frame(行业,zu,pc1,y,row.names = NULL)
zu1
\end{lstlisting}
输出结果为：
\begin{center}
  \includegraphics[scale=0.7]{fig3_4.jpg}
\end{center}


(5)对得分进行排名：
\begin{lstlisting}[language=R][b]
Y=arrange(zu1,-y)
Y
\end{lstlisting}
输出结果为：
\begin{center}
  \includegraphics[scale=0.7]{fig3_5.jpg}
\end{center}
(6)结果分析：\\
综合得分超过平均水平的依次是其他采矿业、非金属矿采选业、有色金属矿采选业和黑色金属矿采选业。
这几个行业的经济效益较高，经济效益最差的为煤矿开采和洗选业、石油和天然气开采业。\\
~\\
4.使用以下代码计算：（因数据输入过于冗长选择省略）
\begin{lstlisting}[language=Matlab][b]
g=[...]             %省略
g_1=zscore(g)       %标准化
g_2=corrcoef(g_1)   %相关系数矩阵
[x,y,z]=pcacov(g_2) %主成分分析函数
\end{lstlisting}
得到相关系数矩阵\\
~\\
X=
$\left[
\begin{array}{ccccccc}
0.4121&0.3023&0.1982&-0.5939&0.0951&-0.4832&-0.3229\\
0.4658&0.1514&-0.0817&-0.1231&0.2533&0.1167&0.8127\\
-0.2129&0.6000&0.3636&0.3239&0.5756&0.1262&-0.1017\\
0.4168&-0.2932&-0.3374&-0.0022&0.5033&0.4272&-0.4367\\
0.4545&0.0193&-0.1233&0.7176&-0.0805&-0.5014&-0.0707\\
0.3994&0.3508&0.2434&0.0847&-0.5681&0.5504&-0.1590\\
0.1674&-0.5624&0.7959&0.0717&0.1139&0.0097&0.0628
\end{array}
\right]$,\\
~\\
特征值y=[4.2825 1.9244 0.4244 0.1812 0.1118 0.0556 0.0201],\\
贡献率z=[61.1784 27.4918 6.0627 2.5884 1.5967 0.7944 0.2877].\\
可以得到：\\
在第一主成分中排行靠前的因素是人均地区生产总值、人均第三产业增加值、第二产业占GDP的比重，排行前三的是上海、北京、天津，\\
在第二主成分中排行靠前的因素是第三产业固定资产投资比重、人均地区生产总值、第三产业就业人员比重，排行前三的是浙江、黑龙江、江西，\\
在第三主成分中排行靠前的因素是人均第三产业增加值、第三产业就业人员比重、第二产业占GDP的比重，排行前三的是湖南、云南、江西。\\
总分排行前三的是上海、北京、天津。\\
~\\
5.根据题意列出matlab代码如下：
    \begin{lstlisting}[language=matlab, linewidth=0.9\linewidth]
    clear
    clc
    %读取数据，并进行标准化变换
    X = [5561.54 1571.74 1286.32 1096.57 1563.10 2293.23 2383.52 704.24;
    5005.09 1153.66 1528.28 817.18 1220.92 1567.87 1608.97 520.49;
    3155.40 1137.22 1097.41 574.84 808.88 1062.31 946.38 304.28;
    2974.76 1137.11 1250.87 471.65 769.79 931.33 1041.91 228.53;
    3553.48 1616.56 1028.19 672.64 869.71 1191.70 1383.53 512.81;
    4378.14 1187.41 1270.95 507.40 913.13 1295.70 1145.46 533.29;
    3307.14 1259.62 1285.28 510.49 914.47 954.96 1071.80 425.30;
    3128.10 1217.04 941.25 494.49 864.89 749.05 906.19 321.95;
    7108.62 1520.61 1646.19 1182.24 755.29 3373.19 2874.54 937.21;
    4544.64 1166.91 1042.10 813.45 794.63 1357.96 1799.75 458.10;
    5522.56 1546.46 1333.69 713.31 933.11 2392.63 2195.58 520.95;
    3905.05 1010.61 988.12 579.59 633.93 920.77 1160.14 325.82;
    5078.85 1105.31 1300.10 722.17 540.63 1777.06 1453.18 523.83;
    3633.05 969.58 851.15 623.17 483.96 872.57 945.99 337.91;
    3699.42 1394.11 1247.04 806.35 799.79 1410.45 1277.43 372.01;
    3079.82 1141.76 963.59 633.32 790.87 915.12 988.95 324.03;
    3996.27 1099.16 914.26 604.40 675.32 890.12 1037.24 260.74;
    3970.42 1090.72 960.82 674.84 790.95 971.05 1110.11 376.62;
    5866.91 975.06 1748.16 947.54 836.39 262308 1936.38 594.45;
    4082.99 772.28 891.33 603.84 529.36 1376.03 1081.54 290.04;
    4226.90 491.84 1106.39 565.51 536.40 1303.50 930.84 247.08;
    4418.34 1294.30 1096.82 842.09 878.25 1044.36 1267.03 305.60;
    4255.48 1042.45 819.28 590.51 564.93 1121.45 947.01 338.03;
    3597.94 851.50 836.54 525.70 471.39 871.15 934.73 260.27;
    4272.29 1026.50 739.20 331.94 606.86 1216.46 732.95 150.42;
    4262.77 1011.82 634.94 310.22 317.08 966.74 419.59 400.38;
    3586.13 1047.61 1007.68 618.16 862.70 967.52 1281.58 400.68;
    3183.79 1022.62 846.26 546.23 654.82 817.17 936.33 301.40;
    3315.94 945.14 802.73 538.54 610.02 787.63 880.86 311.72;
    3352.83 1178.88 1069.15 596.81 816.87 1096.32 1043.72 403.71;
    3235.77 1245.02 781.30 535.31 643.48 1003.89 812.36 411.63];
    XZ = zscore(X); %数据标准化
    %主成分分析
    % 调用princomp函数根据标准化后原始样本观测数据作主成分分析
    %返回主成分表达式的系数矩阵COEFF，主成分得分数据SCORE
    %样本相关系数矩阵的特征值向量latent和每个观测值的霍特林T2统计量
    [COEFF,SCORE,latent,tsquare] = princomp(XZ)
    % 为了直观，定义元胞数组result1，用来存放特征值、贡献率和累积贡献率等数据
    %princomp函数不返回贡献率，需要用协方差矩阵的特征值向量latent来计算
    explained = 100*latent/sum(latent);%计算贡献率

    [m, n] = size(X);%求X的行数和列数
    result1 = cell(n+1, 4);%定义一个n+1行、4列的元胞数组
    %result1中第一行存放的数据
    result1(1,:) = {'特征值', '差值', '贡献率', '累积贡献率'};

    %result1中第1列的第2行到最后一行存放的数据(latent) 特征值
    result1(2:end,1) = num2cell(latent);

    %result1中第2列的第2行到倒数第2行存放的数据(latent 的方差，特征值的方差)
    result1(2:end-1,2) = num2cell(-diff(latent));

    %result1中第3列和第4列的第2行到最后一行分别存放主成分的贡献率和累积贡献率
    result1(2:end,3:4) = num2cell([explained, cumsum(explained)])

    % 为了直观，定义元胞数组result2，用来存放前2个主成分表达式的系数数据
    result2 = cell(n+1, 3); %定义一个n+1行，3列的元胞数组
    result2(1,:) = {'标准化变量', '特征向量t1', '特征向量t2'};%result2的第一行数据
    %result2(2:end, 1) = ['食品','衣着','居住','家庭设备及服务','交通和通讯','文教娱乐','医疗保健','其他';];%result2第1列
    result2(2:end, 2:end) = num2cell(COEFF(:,1:2)) %存放前2个主成表达式的系数矩阵

    % 为了直观，定义元胞数组result3，用来存放每一个地区总的消费性支出，以及前2个主成分的得分数据
    cityname = ['北京','天津','河北','山西','内蒙古','辽宁','吉林','黑龙江','上海','江苏','浙江','安徽','福建','江西','山东','河南','湖北','湖南','广东','广西','海南','重庆','四川','贵州','云南','西藏','陕西','甘肃','青海','宁夏','新疆'];
    sumXZ = sum(XZ,2);      %按行求和，提取每个地区总的消费性支出
    [s1, id] = sortrows(SCORE,1);%将主成得分数据SOCRE按第一主成分得分(第一列)从小到大排序
    result3 = cell(m+1, 4);%定义一个m+1行，4列的元胞数组
    result3(1,:) = {'地区', '总支出', '第一主成分得分y1', '第二主成分得分y2'}; %第一行的数据
    %result3(2:end, 1) = cityname(id);%result3的第一列的数据，排序后的城市名
    %result3第2列为按id排序的sumXZ，第3列为第一主成分得分y1，第4列为第二主成分得分y2
    result3(2:end, 2:end) = num2cell([sumXZ(id), s1(:,1:2)])
    \end{lstlisting}
    最后得出的结果为:
    \begin{figure}[htp]
    \centering
    \includegraphics[width=0.88\linewidth]{COFFEE.png}
    \caption{特征矩阵}
    \end{figure}
    \begin{figure}[htp]
    \centering
    \includegraphics[width=0.88\linewidth]{result1.png}
    \caption{result1}
    \end{figure}
    \begin{figure}[htp]
    \centering
    \includegraphics[width=0.88\linewidth]{result2.png}
    \caption{result2}
    \end{figure}
    \begin{figure}[htp]
    \centering
    \includegraphics[width=0.88\linewidth]{result3.png}
    \caption{result3}
    \end{figure}
    从结果result1来看，前5个主成分的累积贡献率达到了百分之94.9589，所以只用前两个主成分就可以了。有结果result2 写出前5个主成分的表达式如下：\\
     y1=0.3431*x1+0.3384*x2+0.3552*x3+0.3692*x4+0.3752*x5+0.3587*x6+0.3427*x7+0.3441*x8\\
     y2=0.5035*x1-0.4866*x2+0.1968*x3+0.1088*x4-0.0547*x5-0.2208*x6-0.4783*x7+0.4225*x8\\
~\\
~\\
\textbf{一、因子分析}\\
1.计算原始数据的相关矩阵R及其特征值和特征向量，$matlab$代码如下：
              \footnotesize
              \begin{lstlisting}[language=matlab, linewidth=0.9\linewidth]
clc;clear;
data = [1.611,10.59,0.69,1.67;
        1.429,9.44,0.61,1.5;
        1.447,5.97,0.24,1.25;
        1.572,10.72,0.75,1.71;
        1.483,10.99,0.75,1.44;
        1.371,6.46,0.41,1.31;
        1.665,10.51,0.53,1.52;
        1.403,6.11,0.17,1.32;
        2.620,21.51,1.4,2.59;
        2.033,24.15,1.8,1.89;
        2.015,26.86,1.93,2.02;
        1.501,9.74,0.87,1.48;
        1.578,14.52,1.12,1.47;
        1.735,14.64,1.21,1.91;
        1.453,12.88,0.87,1.52;
        1.765,17.94,0.89,1.4;
        1.532,29.42,2.52,1.8;
        1.488,9.23,0.81,1.45;
        2.586,16.07,0.82,1.83;
        1.992,21.63,1.01,1.89];
    e = mean(data,1);
    v = std(data,0,1);
    for i = 1:4
        data(:,i) = (data(:,i)-e(i))/v(i);
    end
     R = cov(data);
     [ga,lan] = eig(R);
                \end{lstlisting}
                \normalsize
                得：
                \begin{center}
                    $\lambda = \left(
                                 \begin{array}{cccc}
                                   0.0369 & 0 & 0 & 0 \\
                                   0 & 0.1665 & 0 & 0 \\
                                   0 & 0 & 0.7822 & 0 \\
                                   0 & 0 & 0 & 3.0145 \\
                                 \end{array}
                               \right)$,
                    $\gamma = \left(
                                 \begin{array}{cccc}
                                   -0.3156 & -0.5126 & 0.6590 & 0.4509 \\
                                    0.6624 & -0.3895 & -0.3516 & 0.5347 \\
                                   -0.6483 & 0.0899 & -0.5758 & 0.4900 \\
                                    0.2033 & 0.7599 & 0.3325 & 0.5202 \\
                                 \end{array}
                               \right)$.
                \end{center}
                根据提取方差贡献大于1决定因子提取个数的方式，四个变量有一个公因子，因子载荷阵为：
                $$A = \left(
                        \begin{array}{cc}
                              0.7829 & 0.5828 \\
                              0.9284 & -0.3110 \\
                              0.8508 & -0.5092 \\
                              0.9033 & 0.2941 \\
                        \end{array}
                      \right)$$
          （2） 调用$[lambda,psi,T,stats,F] = factoran(data,1);$和$Y = sort(F)$得因子得分阵F以及排序后的矩阵Y:
              $$F = \left(
                      \begin{array}{c}
                       -0.5524 \\
                       -0.7215 \\
                       -1.2269 \\
                       -0.5307 \\
                       -0.5001 \\
                       -1.1492 \\
                       -0.5750 \\
                       -1.2104 \\
                        1.0274 \\
                        1.3930 \\
                        1.7774 \\
                       -0.6651 \\
                        0.0101 \\
                        0.0429 \\
                       -0.2309 \\
                        0.4704 \\
                        2.1540 \\
                       -0.7397 \\
                        0.2265 \\
                        1.0001 \\
                      \end{array}
                    \right),
              Y = \left(
                      \begin{array}{c}
                       -1.2269 \\
                       -1.2104 \\
                       -1.1492 \\
                       -0.7397 \\
                       -0.7215 \\
                       -0.6651 \\
                       -0.5750 \\
                       -0.5524 \\
                       -0.5307 \\
                       -0.5001 \\
                       -0.2309 \\
                        0.0101 \\
                        0.0429 \\
                        0.2265 \\
                        0.4704 \\
                        1.0001 \\
                        1.0274 \\
                        1.3930 \\
                        1.7774 \\
                        2.1540 \\
                      \end{array}
                    \right)$$
              可得以下分类：\\
              公因子小于-1：企业3、8、6；\\
              公因子大于-1小于0：企业1、2、4、5、7、12、15、18；\\
              公因子大于0小于1：企业13、14、16、19；\\
              公因子大于1：企业9、10、11、17、20；\\
              而根据最短距离法聚类分析的如下聚类图：
              \begin{figure}[h]
        	    \centering
                 \includegraphics[width=0.48\linewidth]{two_1(2).png}
                \caption{聚类图}
              \end{figure}
~\\
2.利用matlab进行因子分析求解，代码如下：
\footnotesize
\begin{lstlisting}[language=matlab, linewidth=0.9\linewidth]
clear;clc;
grades=[65 61 72 84 81 79
       77 77 76 64 70 55
       67 63 49 65 67 57
       80 69 75 74 74 63
       74 70 80 84 81 74
       78 84 75 64 71 64
       66 71 67 52 65 57
       77 71 57 72 86 71
       83 100 79 41 67 50
       86 94 97 51 63 55
       74 80 88 64 73 66
       67 84 53 58 66 56
       81 62 69 56 66 52
       71 64 69 56 66 52
       78 96 81 80 89 76
       69 56 67 75 94 80
       77 90 80 68 66 60
       84 67 75 60 70 63
       62 67 83 71 85 77
       74 65 75 72 90 73
       91 74 97 62 71 66
       72 87 72 79 83 76
       82 70 83 68 77 85
       63 70 60 91 85 82
       74 79 95 59 74 59
       66 61 77 62 73 64
       90 82 98 47 71 60
       77 90 85 68 73 76
       91 82 84 54 62 60
       78 84 100 51 60 60];
 varnames={'数学','物理','化学','语文','历史','英语'}';
 obsname=1:30;
 obsname=obsname';
 [lambda,psi,T,stats,F]=factoran(grades,2)
contribut=100*sum(lambda.^2)/6
cumcont=cumsum(contribut)
result1=num2cell(lambda);
result=[varnames,result1]
obsF=[num2cell(obsname),num2cell(F)]
j=1;k=1;
for i=1:30
    if F(i,1)<F(i,2)
        li(j)=i;
        j=j+1;
    else
        wen(k)=i;
        k=k+1;
    end
end
fprintf('适合学理科的学生有：')
for i=1:j-1
    fprintf('%6d',li(i))
end
fprintf('\n适合学文科的学生有：')
for i=1:k-1
    fprintf('%6d',wen(i))
end
\end{lstlisting}
\normalsize

运行结果得：

适合学理科的学生有：     2     6     7     9    10    11    13    14    17    18    21    25    27    28    29    30

适合学文科的学生有：     1     3     4     5     8    12    15    16    19    20    22    23    24    26
~\\
首先我们将数据进行标准化，并求出相关系数矩阵的特征值与特征向量。由累计贡献率$\geq85\%$可得，主成分个数为2。
根据主成分分析可求出最后得分。
\small
\begin{lstlisting}[language=Matlab][b]
data=readtable('2.3.txt')
data1=table2array(data)
data2=zscore(data1)
R=corrcoef(data2)
[X,B]=eig(R)
D=[X(:,4),X(:,3)]
Z1=data2*X(:,4)
Z2=data2*X(:,3)
Y=0.8125*Z1+0.1171*Z2
T=[data table(Y)]
\end{lstlisting}
\large
\begin{table}
  \centering
  \begin{tabular}{|c|c|c|c|c|}
    \hline
    % after \\: \hline or \cline{col1-col2} \cline{col3-col4} ...
  X1 & X2 & X3 & X4 & Y\\
148 &	41 &	72	 & 78 &	0.129984704927520\\
139 &	34 &	71 &	76 &	-1.07456464145637\\
160 &	49 &	77 &	86 &	2.32269772178046\\
149 &	36 &	67 &	79 &	-0.597122474426747\\
159 &	45 &	80 &	86 &	2.25623865516670\\
142 &	31 &	66 &	67 &	-2.18911187105665\\
153 &	43 &	76 &	83 &	1.23132242731129\\
150 &	43 &	77 &	68 &	0.213091849348462\\
151 &	42 &	77 &	80 &	0.956714099952568\\
139 &	31 &	68 &	74 &	-1.70774258101044\\
140 &	29 &	64 &	74 &	-2.18154848446046\\
161 &	47 &	78 &	84 &	2.19166715580869\\
158 &	49 &	78 &	83 &	2.12244864961014\\
140 &	33 &	67 &	77 &	-1.41012536112365\\
137 &	31 &	66 &	73 &	-2.06254811279223\\
152 &	35 &	73 &	79 &	0.0472259919661948\\
149	 & 47 &	82 &	79 &	1.63247091664650\\
145 &	35 &	70 &	77 &	-0.722326720645010\\
160 &	47 &	74 &	87 &	1.95553682319784\\
156 &	44 &	78 &	85 &	1.77572350553617\\
151 &	42 &	73 &	82 &	0.708048201407704\\
147 &	38 &	73 &	78 &	-0.0503339843646239\\
157 &	39 &	68 &	80 &	0.194753559948864\\
147 &	30 &	65 &	75 &	-1.58974132312199\\
157 &	39 &	68 &	80 &	0.194753559948864\\
151 &	36 &	74 &	80 &	0.228230252021998\\
144 &	36 &	68 &	76 &	-0.951422634578072\\
141 &	30 &	67 &	76 &	-1.64573869262286\\
139 &	32 &	68 &	73 &	-1.69726925441639\\
148 &	38 &	70 &	78 &	-0.281311938504459\\
    \hline
  \end{tabular}
\end{table}
~\\
4.\\
根据MATLAB得到的载荷矩阵lambda分析：因子Z1可解释为二三产业总值，Z2解释为二三产业分别占的比重\\
\small
\begin{lstlisting}[language=Matlab][b]
%q2_4
clear;clc;
X=[63029 5186.03 25.7 73.2 72.5 84.9 0.364
    55473 2383.56 60.1 37.9 44 77.23 0.344
    23239 853.68 54.2 33.2 26.5 41.9 0.223
    20398 770.16 61.5 34.2 33 45.11 0.2583
    32214 1184.36 55 33.3 32.7 51.71 0.2713
    31259 1192.02 55.8 34.5 41.2 60.05 0.255
    23514 986.40 47.7 38 35.4 53.21 0.2545
    21727 823.053 52.5 34.4 33 55.4 0.336
    73124 4361.24 45.5 53.7 55.2 88.6 0.374
    39622 1669.67 55 38.1 34.7 54.3 0.199
    42214 1919.64 53.9 41 35.3 57.6 0.261
    14485 597.99 46.6 37.4 28.3 40.5 0.248
    30123 1308.21 50 39.3 33.3 49.9 0.336
    14781 506.04 52.7 30.9 31.9 41.6 0.254
    33083 1220.10 57 33.4 31 47.6 0.254
    19593 620.81 56.9 28.6 24.4 36.03 0.201
    19860 887.24 43.8 40.5 40.1 45.2 0.343
    17521 731.36 44.2 37.8 30.4 42.15 0.317
    37589 1787.76 51.6 42.9 38.2 63.37 0.295
    14966 619.61 42.4 37.4 24.8 38.16 0.324
    17175 766.11 29.8 40.2 34.9 48 0.484
    18025 817.38 47.7 41 36.3 49.99 0.321
    15378 590.05 46.3 34.8 33.1 37.4 0.307
    8824 403.46 42.3 41.3 36.3 29.11 0.315
    12587 544.14 43 39.1 25.1 33 0.348
    13861 852.64 29.2 55.5 33.9 22.61 0.541
    18246 663.41 56.1 32.9 32.5 42.1 0.407
    12110 523.051 46.3 39.1 32.8 32.15 0.299
    17389 652.19 55.1 34 34.2 40.86 0.330
    17892 718.00 52.9 36.2 30.1 44.98 0.233
    19893 750.14 49.6 33.9 34.7 39.64 0.273];
[lambda,psi,T,stats,F] = factoran(X,2);
Contribut = 100*sum(lambda.^2)/7;%计算贡献率
CumCont = cumsum(Contribut); %计算累积贡献率
disp('载荷lambda，贡献率contribut和cumcont');
lambda,Contribut,CumCont %得到选取2个因子载荷合理
obsnum=[1:31]';
obsF=[obsnum,F];
disp('按因子Z1排序【第一列为城市序号】');
F1=sortrows(obsF,-2)
disp('按因子Z2排序【第一列为城市序号】');
F2=sortrows(obsF,-3)

% obsF =
%     number   factor1   factor2
%     1.0000    3.0048    3.0163
%     2.0000    1.6345   -1.4503
%     3.0000   -0.1731   -0.7215
%     4.0000   -0.2314   -0.6999
%     5.0000    0.2748   -1.0122
%     6.0000    0.3005   -0.9146
%     7.0000   -0.1459   -0.0770
%     8.0000   -0.2023   -0.5165
%     9.0000    3.0644    0.0471
%    10.0000    0.6990   -0.7743
%    11.0000    0.8733   -0.5028
%    12.0000   -0.6522    0.2160
%    13.0000    0.1662   -0.1280
%    14.0000   -0.5438   -0.6348
%    15.0000    0.3100   -1.0649
%    16.0000   -0.3310   -1.1524
%    17.0000   -0.4028    0.5400
%    18.0000   -0.5275    0.2717
%    19.0000    0.6708   -0.1187
%    20.0000   -0.6863    0.3601
%    21.0000   -0.6504    0.9925
%    22.0000   -0.4445    0.4721
%    23.0000   -0.6165    0.0052
%    24.0000   -1.0510    1.0840
%    25.0000   -0.8375    0.6526
%    26.0000   -1.0580    2.9729
%    27.0000   -0.4020   -0.5226
%    28.0000   -0.8243    0.5953
%    29.0000   -0.4436   -0.3811
%    30.0000   -0.4116   -0.2147
%    31.0000   -0.3625   -0.3396
\end{lstlisting}
\large
5.(1)计算相关系数矩阵：
\begin{lstlisting}[language=R][b]
q5 <- read.table('5.txt',header = F,sep = ' ',col.names = c('x1','x2','x3','x4','x5','x6','x7','x8'))
b <- cor(q5)
\end{lstlisting}
输出结果为：
\begin{center}
  \includegraphics[scale=0.7]{fig5_1.jpg}
\end{center}

(2)分析提取因子数：
\begin{lstlisting}[language=R][b]
library(psych)
fa.parallel(b,n.obs = 31,fa = 'fa',n.iter = 100)
\end{lstlisting}
输出结果为：\\
Parallel analysis suggests that the number of factors =  2  and the number of components =  NA

\begin{center}
  \includegraphics[scale=0.7]{5.jpeg}
\end{center}
现在我们确定提取两个因子，利用函数$fa$求解荷载矩阵。
\begin{lstlisting}[language=R][b]
fa.varimax <- fa(b,nfactors = 2,n.obs = 31,rotate ="varimax",fm="pa",scores = T )
\end{lstlisting}
\begin{center}
  \includegraphics[scale=0.8]{fig5_2.jpg}
\end{center}
我们可以看到，因子1与X1（食品）,X3（居住）,X4（家庭设备用品及服务）,
X7（文教娱乐物品及服务）,X8（其他商品和服务）相关性强，关系密切，
因子2与X2（衣着）,X5（医疗保健）联系紧密，我们可以把因子1叫做“享受型消费因子”，因子2叫做“一般消费因子”，我们分别对因子1、2进行排序。
\begin{lstlisting}[language=R][b]
fa.varimax$weights
attach(q5)
y1 <- 0.14163200*x1-0.53316620*x2+0.22846917*x3+0.07609864*x4-0.04213721*x5+0.12310146*x6+0.50609429*x7+0.19818503*x8
y2 <- -0.19853661*x1+0.75535260*x2-0.05765704*x3+0.01931537*x4+0.04482218*x5-0.04933633*x6+ 0.39197565*x7-0.01565477*x8
detach(q5)
省份<-c('BJ','TJ','HEB','SX1','NMG','LN','JL','HLJ','SH','JS','ZJ','AH','FJ','JX','SD','HEN','HUB','HUN',
        'GD','GX','HAN','CQ','SC','GZ','YN','XZ','SX2','GS','QH','NX','XJ')
q51 <- data.frame(省份,q5,y1,y2)
q52 <- arrange(q51,-y1)
head(q52)
q53 <- arrange(q51,-y2)
head(q53)
\end{lstlisting}
\begin{center}
  \includegraphics[scale=0.68]{fig5_3.jpg}\\
  \includegraphics[scale=0.7]{fig5_4.jpg}\\
\end{center}
可见，广东、上海、北京、浙江、天津、福建、江苏等省（市、自治区）在享受型消费排名靠前，内蒙古、北京、浙江、山东、上海等省（市、自治区）在一般型消费排名靠前。
北京、上海、浙江对于两种消费类型都比较注重。\\
~\\
使用以下代码计算：（因数据输入过于冗长选择省略）
\begin{lstlisting}[language=Matlab][b]
X=[...]             %省略
[ lambda , psi ,T, stats ,F] = factoran (X,3)
contribut = 100*sum(lambda .^2) /7
cumCont = cumsum( contribut )
\end{lstlisting}
得到如下结果：\\
lambda =$\left[
\begin{array}{ccccccc}
0.9610&-0.1786&0.1406\\
    0.2565&-0.2532&0.7596\\
    0.9074&-0.2720&-0.0568\\
   -0.0577&-0.1177&0.9889\\
   -0.2794&0.9514&-0.1086\\
   -0.1534&0.8566&-0.2837\\
    0.9672&-0.1302&0.1646
    \end{array}
\right]$,\\
贡献率为40.76,26.28,24.25，累积为91.29，基本覆盖。\\
可以解释为主要参考因素为地区生产总值、规定资产投资与工业总产值，基本符合实际情况。\\
\end{document}
